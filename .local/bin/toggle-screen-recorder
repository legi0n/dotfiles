#!/usr/bin/env bash

dir="$HOME/Recordings"
mkdir -p "$dir"

flags=()

for arg in "$@"; do
    case "$arg" in
        audio) flags+=(--audio) ;;# Enable audio
    esac
done

if pgrep -x wf-recorder >/dev/null; then
    pkill -INT wf-recorder
    notify-send -i media-playback-stop -t 2500 "Screen Recorder" "Recording saved to $dir!"
else
    geom="$(slurp -o)"
    
    [[ -z "$geom" ]] && exit 0 # If selection was cancelled
    
    wf-recorder -g "$geom" -f "$dir/$(date +%Y-%m-%d_%H-%M-%S).mp4" "${flags[@]}"
fi
